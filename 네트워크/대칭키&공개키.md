# 대칭키 & 공개키

대칭키와 공개키라는 키워드는 암호화 알고리즘에서 많이 사용된다. 즉, 대칭키나 공개키 자체가 특정 알고리즘을 지칭할 때 사용된다. 그리고 검색해보면 알겠지만, 대칭키/대칭키 암호/대칭키 암호화/대칭키 암호 알고리즘 등 비슷비슷한 말들이 정돈되지 않은 채 나온다. 공개키는 더더욱 그러하다. 공개키/공개키 암호화/ 공개키 암호 방식/비대칭키/비대칭 암호/비대칭키 암호 알고리즘 등등... 중요한 건 본질이다! 

정말 정말 간단하게 암호학에 대해 알아보며, 대칭키랑 비대칭키(혹은 공개키)라는 말이 왜 등장했는지 보자.

<br>

### 0. 암호학 겉핥기 중에 겉핥기

- 암호화를 위한 기법(cryptography)이나 암호의 해독법(cryptoanalysis)을 연구하는 학문

  ![](https://i.imgur.com/iRCNCHh.png)

  즉, 위 그림에서 Encryption하고 Decryption 부분을 집중적으로 연구하는 학문이다.


  위 그림을 풀이해보면 다음과 같다.

  1. Plain text에서 암호화를 거쳐 암호문을 만든다. 이때, Key는 있어도 되고 없어도 된다.
  2. 암호문을 복호화해서 본래의 Plain text를 만든다. 이때도 Key는 있어도 되고 없어도 된다.

  즉, 여기서 Optional이라고 불리는 Key가 양쪽이 같으면 `대칭키`, 각각 다른 키를 사용하면 `공개키`혹은 `비대칭키` 라는 말을 사용하는 것이다.

<br>

### 1. 대칭키(Symmetric Key) 혹은 대칭키 암호 알고리즘(Symmetric Key Algorithm)

![](https://i.imgur.com/agzLmxr.png)

- 암호화 기법 중 암호화할 때 사용한 키와 복호화할 때 사용한 키가 같은 암호 기법
- 대칭형 암호화 기법이라고도 함

**장점**

- 대개 대칭키를 이용한 암호화/복호화 알고리즘의 속도가 빠르고 효율적이라고 함
  - 알고리즘의 내부 구조가 간단한 치환(대치)과 전치(뒤섞기)의 조합으로 되어 있어서 알고리즘을 쉽게 개발할 수 있음
  - 동일한 이유로 컴퓨터 시스템에서 빠르게 동작

**단점**

- 그러나 송수신자 간에 동일한 키를 공유해야 하므로 많은 사람들과의 정보교환 시 많은 키를 생성, 유지, 관리해야 하는 어려움이 있음

  ex) 현우와 병화가 `ABC`라는 대칭키를 이용해서 파일을 암호화하고 주고 받았다. 이후, 현우는 민수에게 어떤 파일을 암호화해서 줘야 하는데, `ABC`를 또 이용하면 병화가 알고 있던 `ABC`와 동일하기 때문에 병화가 복호화를 시도해볼 가능성이 존재한다. 그러니 `DEF`라는 새로운 키를 만들어야 안전하다.

- 또한, 정보 교환 과정에서 암호화되지 않은 암호키를 탈취당하거나 노출될 시 보안에 큰 취약점이 생김

**대표적 기법**

1. DES (Data Encryption Standard)
   - 미 정부(NIST)가 의뢰해 IBM이 개발한 암호 표준으로 일반 대중들이 사용하도록 할 목적으로 개발
   - 암호의 핵심 기법인 전치(transposition)와 대체(substitution)을 기반으로 만들어짐
   - 키가 너무 짧다는 이유로 안정성에 대한 문제가 제기되었고, 이후 이중 DES, 삼중 DES가 등장했지만 결국 현대에는 거의 쓰지 않음
2. AES (Advanced Encryption System)
   - DES의 안정성 문제를 극복하고자 미 정부(NIST)는 공개 경쟁을 통해 Rijindael 을 새로운 암호화 시스템으로 선정했고, Rijindael은 AES 라는 이름으로 더 많이 알려져 있음
   - 단일 프로세서에도 손쉽게 구현할 수 있을 정도의 빠른 알고리즘
     - DES의 경우 64비트를 한 블록으로 책정한 후 16회 동안 반복하여 블록 암호화 진행
     - 그에 반해 AES는 전치와 대체와 함께 Shift, XOR, + 연산을 활용하여 128비트는 10회, 192비트는 12회 , 256비트는 14회만 반복하여 구현

<br>

### 2. 공개키(Public Key) 혹은 비대칭키(Asymmetric Key) 암호 알고리즘

![](https://i.imgur.com/XoV4P2l.png)

- 암호화 기법 중 암호화할 때 사용한 키와 복호화할 때 사용한 키가 다른 암호 기법

  - 암호화할 때 사용하는 키는 `공개키(Public Key)`
  - 복호화할 때 사용하는 키는 `비밀키(Private Key)`
  - 두 키는 하나의 쌍

- 비대칭형 암호화 기법이라고도 함

- 공개키를 활용한 암호화 방식의 진행 과정 (오전에 그림을 보며 설명하겠습니다. 그림만 봐선...)

  ![](https://i.imgur.com/kiJNn3i.png)

  > S(Sender): 송신자, R(Receiver): 수신자, O(Other): 제 3자

  1. R은 어떠한 방법을 통해 공개키와 비밀키를 생성하고, 공개키를 누구나 볼 수 있는 공간에 오픈한다. (보통 현대에서 '어떠한 방법'은 RSA를 의미한다.)

  2. S는 송신하고자 하는 Plain Text를 R의 공개키를 사용하여 암호화한다.

  3. 암호문은 네트워크 통신을 통해 R에게 전달되며, R의 개인키를 사용하여 복호화를 할 수 있다.

  4. 이때, R에게 전달되는 암호문을 제 3자인 O가 탈취할 수 있다. 만약 대칭키 방식이었고, S와 R 사이에 key가 교환되는 과정에서 key를 탈취했더라면 O는 암호문을 복호화할 수 있을 것이다.

     하지만 비대칭키 방식에서는 복호화할 수 있는 유일한 수단인 R의 비밀키가 밖으로 노출될 일이 없기 때문에, 제 3자가 암호문을 가로채도 복호화할 수 없다.

**장점**

- 더이상 키 자체를 주고 받을 일이 없기 때문에 보안이 강화됨 (개인의 비밀키가 노출될 경우 대칭형 암호화 기법과 동일한 보안 이슈가 생기지만, 비밀키를 주고 받을 일이 없기 때문에 일반적으로는 비밀키가 노출될 경우가 극히 드뭄)

**단점**

- 대칭형 암호화 기법에 비해 암호화/복호화에 더 많은 시간이 소요됨
  - 대표적인 비대칭형 암호화 기법인 RSA는 암호화를 지수화(exponentiation) 연산에 의존하므로 엄청나게 많은 계산량이 필요하고, 당연히 느림. 복호화 또한 마찬가지.

**대표적 기법**

RSA (Rivest-Shamir-Adelman) 알고리즘

- MIT의 Ronald Rivest , Adi Shamir, Leonard Adleman 가 1978년에 개발
- 최소 256비트의 키를 사용하고, 전문가들은 대체로 1,000 ~ 2,000비트의 키를 선호
- 암호화는 지수화 (exponentiation) 연산에 의존하여, DES 나 AES 에 비해 엄청나게 많은
  계산량이 필요하고 훨씬 느림
- 소수분해에 기반한 알고리즘으로 되어 있어, 매우 안전한 기반으로 인식됨

- RSA의 핵심은 "아~~~~주 큰 숫자가 있는데, 그 숫자를 만들기 위해서는 두 소수를 곱해야 해. 그 두 소수가 뭘까?" 이다. 말은 쉽지만 너무 큰 숫자라 무차별대입으로 다 곱해보기 쉽지 않아서 뚫기 힘든 것이라고 함.

> RSA 알고리즘 암호화 단계
>
> 1. 암호키는 (e, n)의 쌍이고 , 복호키는 (d, n) 의 쌍이다.
> 2. `n = p x q` 로 이루어진 아주 큰 값을 선택한다. 
>    (p, q 는 소수이며 , 대체로 100자리 정도를 사용)
> 3. φ(n) = (p-1)(q-1)에 서로소이면서 1 < e < φ(n) 를 만족하는 e 값을 선택한다.
> 4. `d x e mod φ(n) = 1`을 만족하는 d를 선택한다.
>
> 
> 예시
>
> 1. p = 3, q = 11, n = 3 x 11 = 33
> 2. (p-1) x (q-1) = 2 x 10 = 20
>    -> e는 20 에 서로소인 7 을 선택
> 3. (d x 7) mod 20 = 1
>    -> 위 식을 만족시키는 d 값으로 3을 선택
> 4. 암호키 = (7, 33), 복호키 = (3, 33)
>
> - 9를 암호화하면 , 9^7 mod 33 = 4782969 mod 33 = 15
>
> - 15를 복호화하면 , 15^3 mod 33 = 3375 mod 33 = 9

<br>



레퍼런스

[1. 생활코딩 유튜브 - 암호화 2 : 공개키 방식](https://www.youtube.com/watch?v=_6Ri-Ha5uZE)
